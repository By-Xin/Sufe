ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "above")
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
legend("hello")+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate("blue:logdiff")+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate("blue:logdiff",x=20,y=4)+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate("blue:logdiff",x=10,y=4)+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate("blue:logdiff",x=4,y=4)+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate(label="blue:logdiff",x=4,y=4)+
theme_bw()
ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
annotate(label="blue:logdiff",color="blue")+
theme_bw()
gph+  annotate(label="blue:logdiff",color="blue")
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
gph+  annotate(label="blue:logdiff",color="blue")
gph +
annotate(label="blue:logdiff",color="blue")
gph +
annotate("text",label="blue:logdiff",color="blue")
gph +
annotate("text",label="blue:logdiff",color="blue",x=20)
gph +
annotate("text",label="blue:logdiff",color="blue",x=20,y=5)
gph +
annotate("text",label="blue:logdiff",color="blue",x=10,y=5)
gph +
annotate("text",label="blue:logdiff",color="blue",x=10,y=1)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=1)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=1)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=3)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=1)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=2)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=1)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1.5)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=1)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=.5)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=12,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=13.4,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14,y=1.6)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14,y=1.4)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
geom_point(mapping=aes(y=logdiff,x=time)
geom_point(mapping=aes(y=logdiff,x=time)+
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time))+
geom_point(mapping=aes(y=logdiff,x=time))+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="white")+
geom_point(mapping=aes(y=logdiff,x=time))+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time))+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time),color='blue',shape=1)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_bw()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.7)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.8)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time),color='blue',shape=1)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_classic()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.8)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("formatR")
library(formatR)
library(TSA)
library(ggplot2)
data("jj")
library(TSA)
data("jj")
data("JJ")
plot(JJ,type='o')
plot(JJ,type='o',ylab='Johnson & Johnson')
plot(JJ,type='o',ylab='Johnson & Johnson Quarterly Earnings')
BoxCox.ar(JJ)
boxcox <- BoxCox.ar(JJ)
View(boxcox)
plot(boxcox)
boxcox <- BoxCox.ar(JJ)
boxcox <- BoxCox.ar(JJ)
plot(boxcox)
boxcox$lambda
boxcox$loglike
max(boxcox$loglike)
boxcox <- BoxCox.ar(JJ)
boxcox$loglike[max(boxcox$loglike)]
boxcox$loglike[== max(boxcox$loglike)]
max(boxcox$loglike)
which.max(boxcox$loglike)
boxcox$lambda[which.max(boxcox$loglike)]
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
print(lambda_opt)
print(cat("The optimum lambda:",lambda_opt))
boxcox <- BoxCox.ar(JJ)
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
print(cat("The optimum lambda:",lambda_opt))
boxcox_jj <- 5*(jj^0.2-1)
boxcox_JJ <- 5*(JJ^0.2-1)
plot(boxcox_JJ,type='o')
plot(boxcox_JJ,type='o',ylab=expression(JJ \lambda=0.5))
plot(boxcox_JJ,type='o',ylab=expression(JJ lambda))
plot(boxcox_JJ,type='o',ylab='JJ lambda=0.2')
plot(boxcox_JJ,type='o',ylab='JJ (lambda=0.2)')
plot(boxcox_JJ,type='o',ylab='JJ ( with lambda=0.2 )')
boxcox <- BoxCox.ar(JJ,lambda = seq(-2,2,0.01))
boxcox <- BoxCox.ar(JJ,lambda = seq(-2,2,0.02))
boxcox <- BoxCox.ar(JJ)
bc_lam <- BoxCox.ar(JJ,lambda=seq(0,1,0.01))
bc_lam <- BoxCox.ar(JJ,lambda=seq(0,1,0.01),plotit = FALSE)
bc_lam <- BoxCox.ar(JJ,lambda=seq(0,1,0.01),plotit = FALSE)
boxcox <- BoxCox.ar(JJ)
boxcox <- BoxCox.ar(JJ)
bc_lam <- BoxCox.ar(JJ,lambda=seq(0,1,0.01),plotit = FALSE)
boxcox <- BoxCox.ar(JJ)
lambda_opt <- bc_lam$lambda[which.max(boxcox$loglike)]
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
boxcox <- BoxCox.ar(JJ)
View(boxcox)
boxcox <- BoxCox.ar(JJ,seq(0.01))
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
boxcox <- BoxCox.ar(JJ,seq(0.001))
boxcox <- BoxCox.ar(JJ,seq(0.001))
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
boxcox <- BoxCox.ar(JJ,seq(0.001))
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
boxcox_JJ <- 5*(JJ^0.2-1)
for (time in c(1:83)){
diff_boxcox_JJ[time+1] <- boxcox_JJ[time+1]-boxcox_JJ[time]
}
diff_boxcox_JJ <- 0
for (time in c(1:83)){
diff_boxcox_JJ[time+1] <- boxcox_JJ[time+1]-boxcox_JJ[time]
}
plot(diff_boxcox_JJ,type='o',ylab='JJ ( with lambda=0.2 )')
plot(diff_boxcox_JJ,type='o',ylab='log JJ ( with lambda=0.2 )',xlab='Time')
plot(diff_boxcox_JJ,type='o',ylab='log(JJ) ( with lambda=0.2 )',xlab='Time')
plot(diff_boxcox_JJ,x=c(1960:1980),type='o',ylab='log(JJ) ( with lambda=0.2 )',xlab='Time')
plot(diff_boxcox_JJ,type='o',ylab='log(JJ) ( with lambda=0.2 )',xlab='Time')
knitr::opts_chunk$set(echo = TRUE)
#install.packages("formatR")
library(formatR)
library(TSA)
library(ggplot2)
rcr <- diff(winnebago)
logdiff <- diff(log(winnebago))
plot(rcr,x=c(1:63),type = "o",ylab="Relative change rate",xlab="Time")
plot(logdiff,ylab="Log difference",x=c(1:63),type = "o",xlab="Time")
time <- c(1:63)
dat <- as.data.frame(cbind(time,rcr,logdiff))
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time),color='blue',shape=1)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_classic()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.8)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
rcr <- diff(winnebago)
logdiff <- diff(log(winnebago))
plot(rcr,x=c(1:63),type = "o",ylab="Relative change rate",xlab="Time")
plot(logdiff,ylab="Log difference",x=c(1:63),type = "o",xlab="Time")
time <- c(1:63)
dat <- as.data.frame(cbind(time,rcr,logdiff))
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time),color='blue',shape=1)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_classic()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.8)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
rcr <- diff(winnebago)
logdiff <- diff(log(winnebago))
plot(rcr,x=c(1:63),type = "o",ylab="Relative change rate",xlab="Time")
plot(logdiff,ylab="Log difference",x=c(1:63),type = "o",xlab="Time")
time <- c(1:63)
rcr <- 0
logdiff <- diff(log(winne))
for (t in 1:63){
rcr[t] <- winnebago[t+1]/winnebago[t]-1
logdiff[t] <- log(winnebago[t+1])-log(winnebago[t])
}
rcr <- 0
logdiff <- diff(log(winnebago))
rcr <- 0
logdiff <- diff(log(winnebago))
for (t in 1:63){
rcr[t] <- winnebago[t+1]/winnebago[t]-1
}
plot(rcr,x=c(1:63),type = "o",ylab="Relative change rate",xlab="Time")
plot(logdiff,ylab="Log difference",x=c(1:63),type = "o",xlab="Time")
time <- c(1:63)
dat <- as.data.frame(cbind(time,rcr,logdiff))
gph <- ggplot(dat)+
geom_line(mapping=aes(y=rcr,x=time ), color="red")+
geom_line(mapping=aes(y=logdiff,x=time),color="blue",alpha=0.7)+
geom_point(mapping=aes(y=rcr,x=time),color="red",shape=1)+
geom_point(mapping=aes(y=logdiff,x=time),color='blue',shape=1)+
labs(y="Change Rate", x="Time")+
theme(legend.position = "top")+
theme_classic()
gph +
annotate("text",label="Log Difference",color="blue",x=12.5,y=.8)+
annotate("text",label="Relative Change Rate",color="red",x=14.3,y=1.48)
boxcox_JJ <- 5*(JJ^0.2-1)
diff_boxcox_JJ <- diff(boxcox_JJ)
plot(diff_boxcox_JJ,type='o',ylab='log(JJ) ( with lambda=0.2 )',xlab='Time')
Zt_ACF <- c(.97,.97,.93,.85,.8,.71)
Zt_ACF <- c(.97,.97,.93,.85,.8,.71)
nambda_Zt_ACF <- c(-.42,.18,-.02,.07,-.1,-.09)
n <- 100
barleet <- 0
bartlett.test(Zt_ACF)
?barlett.test
?? barlett.test
? barlett.test
boxcox_JJ <- 5*(JJ^0.2-1)
plot(boxcox_JJ,type='o',ylab='JJ ( with lambda=0.2 )')
boxcox <- BoxCox.ar(JJ)
lambda_opt <- boxcox$lambda[which.max(boxcox$loglike)]
knitr::opts_chunk$set(echo = TRUE)
#install.packages("formatR")
library(formatR)
library(TSA)
library(ggplot2)
set.seed(2023)
arima.sim?
?arima.sim
?arima.sim
dat <- arima.sim(n=48,list(ar=0.7))
plot(dat)
dat_acf <- acf(dat,plot=TRUE,lag.max=5)
set.seed(2023)
dat <- arima.sim(n=48,list(ar=0.7))
dat_acf <- acf(dat,plot=TRUE,lag.max=5)
dat_acf$acf
dat_acf$acf[c(1,5)]
set.seed(2023)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=TRUE,lag.max=5)
dat_acf$acf[c(1,5)]
set.seed(2023)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
dat_acf$acf[c(1,5)]
set.seed(2023)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
dat_acf$acf[c(1,5)]
set.seed(2023)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
dat_acf$acf[c(1,5)]
acf[i] <- dat_acf$acf[c(1,5)]
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf[i] <- dat_acf$acf[c(1,5)]
}
acf
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf <- dat_acf$acf[c(1,5)]
}
acf
acf
acf[1:100] <- 0
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf <- dat_acf$acf[c(1,5)]
}
acf[i] <- dat_acf$acf[c(1,5)]
acf[1:100] <- 0
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf[i] <- dat_acf$acf[c(1,5)]
}
acf
acf_5[1:100] <- 9
acf_1[1:100] <- 0
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
acf_1 <- 0
acf_5 <- 0
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
acf_1
acf_5
histgogram(acf_1)
histogram?
?
?
s
? histogram
histogram(acf_1)
histogram(acf_1)
ggplot(data=acf_1)+
geom_histogram(mapping=(x=acf_1))
lattice::histogram(acf_1)
lattice::histogram(acf_2)
lattice::histogram(acf_5)
hist(acf_1)
hist(acf_5)
var(acf_1)
var(acf_5)
var(acf_5)
var(acf_1)
var(acf_5)
var(acf_1)
var(acf_5)
acf_1 <- 0
acf_5 <- 0
for (i in 1:100){
set.seed(2023+i)
dat <- arima.sim(n=48,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
acf_1
acf_5
hist(acf_1)
hist(acf_5)
var(acf_1)
var(acf_5)
set.seed(2023)
acf_1 <- 0
acf_5 <- 0
for (i in 1:100){
dat <- arima.sim(n=48,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
acf_1
acf_5
hist(acf_1)
hist(acf_5)
var(acf_1)
var(acf_5)
var(acf_1)
var(acf_5)
var1 <- (1-0.7^2)/100
var2 <- (1+0.7^2)/(1-0.7^2)/100
set.seed(2023)
acf_1 <- 0
acf_5 <- 0
for (i in 1:100){
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
var(acf_1)
var(acf_5)
var1 <- (1-0.7^2)/100
var2 <- (1+0.7^2)/(1-0.7^2)/100
var1
var2
set.seed(2023)
acf_1 <- 0
acf_5 <- 0
for (i in 1:100){
dat <- arima.sim(n=100,list(ar=0.7))
dat_acf <- acf(dat,plot=FALSE,lag.max=5)
acf_1[i] <- dat_acf$acf[1]
acf_5[i] <- dat_acf$acf[5]
}
var(acf_1)
var(acf_5)
var1 <- (1-0.7^2)/100
var2 <- (1+0.7^2)/(1-0.7^2)/100
var1
var2
